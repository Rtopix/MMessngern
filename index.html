<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>MMessenger</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Welcome Screen -->
    <div class="screen active" id="welcomeScreen">
        <div class="welcome-screen">
            <div class="logo">MM</div>
            <div class="welcome-title">MMessenger</div>
            <div class="input-container">
                <div class="input-label">–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:</div>
                <input type="text" class="text-input" id="nicknameInput" placeholder="–í–∞—à–µ –∏–º—è">
                <button class="btn primary-btn" onclick="app.saveNickname()">–ù–∞—á–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Chats Screen -->
    <div class="screen" id="chatsScreen">
        <div class="navbar">
            <button class="btn nav-btn logout-btn" onclick="app.logout()">–í—ã—Ö–æ–¥</button>
            <div class="nav-title">–ß–∞—Ç—ã</div>
            <div class="nav-actions">
                <button class="btn nav-btn" onclick="app.refreshChats()" title="–û–±–Ω–æ–≤–∏—Ç—å —á–∞—Ç—ã">üîÑ</button>
                <button class="btn nav-btn" onclick="app.showSearchModal()" title="–ü–æ–∏—Å–∫ –¥—Ä—É–∑–µ–π">üîç</button>
                <button class="btn nav-btn" onclick="app.showAccountModal()" title="–ê–∫–∫–∞—É–Ω—Ç">üë§</button>
            </div>
        </div>
        <div class="content chat-list" id="chatList"></div>
        <div class="btn fab" onclick="app.showNewChatModal()">+</div>
    </div>

    <!-- Chat Screen -->
    <div class="screen" id="chatScreen">
        <div class="navbar">
            <button class="btn nav-btn" onclick="app.backToChats()">‚Üê –ù–∞–∑–∞–¥</button>
            <div class="nav-title" id="chatTitle"></div>
            <div class="nav-spacer"></div>
        </div>
        <div class="content messages-container" id="messagesContainer">
            <div class="typing-indicator" id="typingIndicator"></div>
        </div>
        <div class="message-input-container">
            <input type="file" id="fileInput" style="display: none;" accept="image/*,video/*,*/*" onchange="app.handleFileSelect(event)">
            <button class="btn file-attach-btn" onclick="document.getElementById('fileInput').click()" title="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª">üìé</button>
            <input type="text" class="message-input" id="messageInput" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ">
            <button class="btn send-btn" onclick="app.sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal" id="newChatModal">
        <div class="modal-content">
            <div class="modal-title">–ù–æ–≤—ã–π –∫–∞–Ω–∞–ª</div>
            <input type="text" class="text-input" id="newChatName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞">
            <textarea class="text-input" id="newChatDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞" rows="3"></textarea>
            <div class="modal-buttons">
                <button class="btn modal-btn cancel" onclick="app.closeModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn modal-btn confirm" onclick="app.createChat()">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <div class="modal" id="accountModal">
        <div class="modal-content">
            <div class="modal-title">–í–∞—à –∞–∫–∫–∞—É–Ω—Ç</div>
            <div class="account-info">
                <div class="account-field">
                    <label class="field-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                    <div class="field-value" id="accountUsername"></div>
                </div>
                <div class="account-field">
                    <label class="field-label">–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á:</label>
                    <div class="field-value key-value" id="accountKey"></div>
                    <button class="btn copy-btn" onclick="app.copyKey()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="btn modal-btn confirm" id="friendsModalBtn" onclick="app.showFriendsModal()">
                    –î—Ä—É–∑—å—è <span class="badge" id="requestsBadge" style="display: none;">0</span>
                </button>
                <button class="btn modal-btn confirm" onclick="app.showRestoreModal()">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–∞—Ç—ã</button>
                <button class="btn modal-btn confirm" onclick="app.closeAccountModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <div class="modal" id="searchFriendsModal">
        <div class="modal-content">
            <div class="modal-title">–ü–æ–∏—Å–∫ –¥—Ä—É–∑–µ–π</div>
            <input type="text" class="text-input" id="searchInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            <div class="search-results" id="searchResults"></div>
            <div class="modal-buttons">
                <button class="btn modal-btn cancel" onclick="app.closeSearchModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <div class="modal" id="friendsModal">
        <div class="modal-content">
            <div class="modal-title">–ú–æ–∏ –¥—Ä—É–∑—å—è</div>
            <div class="friends-list" id="friendsList"></div>
            <div class="modal-buttons">
                <button class="btn modal-btn confirm" onclick="app.showFriendRequestsModal()">–ó–∞—è–≤–∫–∏ –≤ –¥—Ä—É–∑—å—è</button>
                <button class="btn modal-btn confirm" onclick="app.showSearchModal()">–ù–∞–π—Ç–∏ –¥—Ä—É–∑–µ–π</button>
                <button class="btn modal-btn confirm" onclick="app.showAddFriendByKeyModal()">–î–æ–±–∞–≤–∏—Ç—å –ø–æ –∫–ª—é—á—É</button>
                <button class="btn modal-btn cancel" onclick="app.closeFriendsModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <div class="modal" id="friendRequestsModal">
        <div class="modal-content">
            <div class="modal-title">–ó–∞—è–≤–∫–∏ –≤ –¥—Ä—É–∑—å—è</div>
            <div class="friends-list" id="friendRequestsList"></div>
            <div class="modal-buttons">
                <button class="btn modal-btn cancel" onclick="app.closeFriendRequestsModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <div class="modal" id="restoreChatsModal">
        <div class="modal-content">
            <div class="modal-title">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–∞—Ç—ã</div>
            <div class="input-label">–í–≤–µ–¥–∏—Ç–µ –≤–∞—à —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á:</div>
            <input type="text" class="text-input" id="restoreKeyInput" placeholder="–í–∞—à –∫–ª—é—á">
            <div class="modal-buttons">
                <button class="btn modal-btn cancel" onclick="app.closeRestoreModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn modal-btn confirm" onclick="app.restoreChats()">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div class="modal" id="addFriendByKeyModal">
        <div class="modal-content">
            <div class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∞ –ø–æ –∫–ª—é—á—É</div>
            <div class="input-label">–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –¥—Ä—É–≥–∞:</div>
            <input type="text" class="text-input" id="friendKeyInput" placeholder="–ö–ª—é—á –¥—Ä—É–≥–∞">
            <div class="input-label">–í–≤–µ–¥–∏—Ç–µ –∏–º—è –¥—Ä—É–≥–∞:</div>
            <input type="text" class="text-input" id="friendNameInput" placeholder="–ò–º—è –¥—Ä—É–≥–∞">
            <div class="modal-buttons">
                <button class="btn modal-btn cancel" onclick="app.closeAddFriendModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn modal-btn confirm" onclick="app.addFriendByKey()">–î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
